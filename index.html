<!DOCTYPE html>
<html lang="en">
  <link rel="stylesheet" href="index.css" />
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>CAT 3 Translation Project</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <canvas id="cnv" class="scene-1"></canvas>
    <canvas id="steel-door" class="scene-2"></canvas>
    <canvas id="c" class="scene-6"></canvas>
    <p id="scene-2-text" class="scene-2"></p>
    
    <div id="animation-layer">
      <div class="horizontal-block first-block"></div>
      <div class="horizontal-block second-block"></div>
      <div class="horizontal-block third-block"></div>
      <div class="horizontal-block fourth-block"></div>
      <div class="horizontal-block fifth-block"></div>
    </div>
    <div class="navbar">
      <!-- <a id="scene-1">Scene 1</a>
    <a id="scene-2">Scene 2</a>
    <a id="scene-3">Scene 3</a> 
              .....-->
    </div>

    <svg
      viewBox="0 0 200 200"
      width="100"
      height="100"
      xmlns="http://www.w3.org/2000/svg"
      id="planet"
      class="scene-1"
    >
      <image href="planet.png" height="200" width="200"></image>
    </svg>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://code.jquery.com/ui/1.13.3/jquery-ui.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/threejs/r84/three.min.js"></script>
    <script>
      function resetHorizontalBlocks() {
        $(".horizontal-block")
          .stop() // Stop any ongoing animations
          .css({
            // Reset styles
            left: "0", // Move blocks off-screen
            width: "100%", // Set width to 0
            borderRadius: "0px", // Reset border-radius
          });
      }
      // $(document).ready(
      function pretransition() {
        // Initial left position to animate from
        $(".horizontal-block").css("left", "-100%");

        // Slide blocks into position
        $(".horizontal-block").animate(
          {
            left: 0,
          },
          500,
          function () {
            // After sliding in, start width animation
            $(".horizontal-block").each(function (index) {
              setTimeout(() => {
                $(this).css("width", "100%");
              }, index * 200); // Stagger the animations by 200 milliseconds
            });
          }
        );
        setTimeout(() => {
          $(".horizontal-block").css("border-radius", "0 5px 5px 0");
        }, 1000);
      }
      // );
      // $(document).ready(
      function transition() {
        // Enhanced easing function for a more prominent bounce effect
        $.extend($.easing, {
          bounce: function (x, t, b, c, d) {
            if ((t /= d) < 1 / 2.75) {
              return c * (7.5625 * t * t) + b;
            } else if (t < 2 / 2.75) {
              return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;
            } else if (t < 2.5 / 2.75) {
              return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;
            } else {
              return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;
            }
          },
        });

        // Function to animate width transition in smaller intervals
        function animateBlocks() {
          var intervals = [80, 60, 40, 0];
          var duration = 150; // 0.1 seconds for each interval
          var stagger = 100; // 0.3 seconds stagger between each block animation

          $(".horizontal-block").each(function (index) {
            var delay = index * stagger;

            intervals.forEach(
              function (width, i) {
                $(this)
                  .delay(delay)
                  .animate(
                    { width: width + "%" },
                    {
                      duration: duration,
                      easing: "bounce",
                      complete: function () {
                        // Optionally, you can do something when each interval completes
                      },
                    }
                  );
                delay += duration;
              }.bind(this)
            ); // Bind 'this' to correctly reference the current block
          });
        }

        // Start the animation
        animateBlocks();
      }
      // );
    </script>
    <script>
      $(document).ready(function () {
        // Loop through scene links from 1 to 9
        for (let i = 1; i <= 9; i++) {
          const sceneLink = $(`#scene-${i}`);
          sceneLink.click(function () {
            resetHorizontalBlocks();
            $(".horizontal-block").css("visibility", "visible");
            pretransition();
            setTimeout(() => {
              transition();
            }, 300);
            setTimeout(() => {
              $(".horizontal-block").css("visibility", "hidden");
              resetHorizontalBlocks();
            }, 6000);
          });
        }
      });
    </script>
    <script src="starting.js"></script>
    <script src="index.js"></script>
    <script src="panning.js"></script>
    <script src="friction.js"></script>
    <script src="scene-1.js"></script>
    <script src="scene-2.js"></script>
    <script src="scene-6.js"></script>
  </body>
</html>
